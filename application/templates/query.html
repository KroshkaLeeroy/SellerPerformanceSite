{% extends "base.html" %}

{% block title %}Запрос{% endblock %}


{% block content %}

<main class="main-content">
    <div class="columns-container">
        <div class="left-column">
            <form action="{{ url_for('profile_blueprint.query_page') }}"  method="post">
            <div class="form-group">
                <label for="date-from">Дата с</label>
                <input type="date" id="date-from" class="info-input" name="date-from">
            </div>
            <div class="form-group">
                <label for="date-to">Дата по</label>
                <input type="date" id="date-to" class="info-input" name="date-to">
            </div>
            {% with messages = get_flashed_messages() %}
            {% if messages %}
            <ul class="flashes">
                {% for message in messages %}
                <li>{{ message }}</li>
                {% endfor %}
            </ul>
            {% else %}
            <button type="submit" class="btn-submit">Запросить отчет</button>
            </form>
            {% endif %}
            {% endwith %}

        </div>

        <div class="right-column">
            <table class="info-table">
                <thead>
                <tr>
                    <th>Дата с</th>
                    <th>Дата по</th>
                    <th>Статус</th>
                </tr>
                </thead>
                <tbody>
                {% for request in requests %}
                <tr>
                    <td>{{ request.date_from }}</td>
                    <td>{{ request.date_to }}</td>
                    <td>
                    {% if request.status == 'need_to_process' %}
                    В очереди на обработку
                    {% elif request.status == 'ready_to_download' %}
                    Готов к скачиванию
                    {% elif request.status == 'some_error' %}
                    Возникла ошибка в подготовке, попробуйте позднее повторить
                    {% endif %}
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</main>
{% endblock %}